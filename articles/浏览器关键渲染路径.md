# 浏览器关键渲染路径

## 一、渲染过程

### 1.构建DOM和CSSOM

DOM和CSSOM是独立的的数据结构。

构建DOM的过程（对应于Chrome DevTool中的parse HTML）：

`Bytes => Characters => Tokens => Nodes => DOM`

构建CSSOM的过程（对应于Chrome DevTool中的Recalculate Style）：

`Bytes => Characters => Tokens => Nodes => CSSOM` 

### 2.构建Render-Tree

接下来，浏览器会把DOM和CSSOM合并成一颗Render-Tree，网罗所有可见DOM。

![](/assets/render-tree-construction.png)

**DOM-Tree和Render-Tree的区别是**：

* Render-Tree没有head、script等不可见标签
* Render-Tree没有display: none的元素
* Render-Tree中增加了CSS伪元素

### 3.Layout

Layout过程计算网页中每个元素的大小和位置。对应于Chrome DevTool中的Layout。

### 4.Paint

进行元素绘制。

## 二、防止阻塞

CSS是阻塞资源，需要将它尽早、尽快地下载到客户端，以便缩短首次渲染时间。

    <link href="style.css"    rel="stylesheet">
    <link href="style.css"    rel="stylesheet" media="all">
    <link href="portrait.css" rel="stylesheet" media="orientation:portrait"> // 可能阻塞渲染
    <link href="print.css"    rel="stylesheet" media="print"> // 不会阻塞渲染
    

